fenrirScan.exe (仮) 
(C) folia

【注意】
試用する前に、pathファイルのバックアップをとってください。
ソフトに不具合があった場合、pathファイルが失われる可能性があります。

***はじめに

fenrir用のスキャンプログラムです。
標準のスキャン機能より、高速、高機能です。
スキャンを行うフォルダ毎に、登録するファイルの種類を設定できたり、
サブフォルダに潜らないスキャンができたりします。
また、スキャン中でもfenrirを使用することができるというメリットが
あります。

fenrir.exe と同じフォルダにおいて、利用してください。

fenrir動作中にスキャン完了した場合は、更新を反映するために
fenrir.exeを再起動します。

レジストリは変更していません。


***スキャン設定

fenrirScan.exeと同じ場所に、ScanRule.iniというファイルを用意し、
編集することでスキャンの設定を行うことが出来ます。

C:\foo以下の*.exeと*.iniとフォルダを取得

  C:\foo,*.exe,*.ini,\

C:\fooにある*.txtを取得（サブフォルダはスキャンしない）

  *C:\foo,*.txt


C:\fooをスキャン対象から除外

  -C:\foo


C:\fooを登録

  +C:\foo

優先順位は 

* > - > 普通のスキャン

です。

例えば、

C:\,\
*C:\desktop,\
-C:\desktop

という指定の場合は、C:\desktopに限り、サブフォルダまでスキャンしません。
また、-C:\desktopは無視されます。


***fenrirScan.iniの解説

PriorityStockCount=1000
アイテムの上位何件を残すかの設定。

PathFilePath=.\data\path
Pathファイルのパス

HashSize=9973
重複登録をはじくためにハッシュ検索というアルゴリズムをつかっているのですが、
そのときに用いるハッシュテーブルのサイズです。小さければメモリ節約になり、大きければ高速になるという特徴があります。
スキャンした結果できるアイテム数の120%近辺の素数を設定するとバランスが良さそうな感じです。

DelimiterString=,
ScanRule.iniで使用する区切り文字列。文字列なので複数の文字でも構いません。

fenrirCommandLine=.\fenrir.exe
fenrir.exeを再起動するときに使用するコマンドライン

ProgressShow=2
0=プログレスを表示しない
1=fenrirのタイトルバーにプログレス表示
2=ダイアログにプログレス表示

ProgressUpdatePer=8
プログレス表示を何個スキャンする毎にアップデートするか。


***その他

このソフトを利用することで生じた、直接的、間接的損害の責任は負いません。


***履歴

----------------------------------------------------------------------
Ver.0.11	09/09/04
----------------------------------------------------------------------

･終了時、fenrirscan.iniのPathFilePathとHashSize がデフォルト値で上書きされてしまう不具合修正。

----------------------------------------------------------------------
Ver.0.10	09/02/26
----------------------------------------------------------------------

・fenrirCommandLineの設定が勝手にデフォルトに戻ってしまう不具合修正。

・dataというディレクトリを勝手に作成する不具合修正。

・PriorityStockCountの値がfenrir.iniのPriorityStockCountsの値で上書きされる不具合修正。

----------------------------------------------------------------------
Ver.0.09a	08/03/10
----------------------------------------------------------------------

・ダイアログを表示したときに、タスクバーにボタンが表示されていたのを
表示しないようにした。


----------------------------------------------------------------------
Ver.0.09	08/03/09
----------------------------------------------------------------------

・ダイアログ位置が正常に復元されない不具合修正。

・ダイアログをキャンセル終了したときに、ProgressMax= にキャンセル時の
スキャン個数を保存していたのを修正。

・ダイアログを最前面属性にした。

----------------------------------------------------------------------
Ver.0.08	08/03/08
----------------------------------------------------------------------

・進捗状況表示のための、ダイアログを作った。

ProgressShow=2 で有効になる。

・デフォルト値変更

ProgerssShow = 1 → ProgerssShow = 2
ProgressUpdatePer = 100 → ProgressUpdatePer = 8

・*指定のスキャンを進捗状況に反映していなかった不具合修正。

----------------------------------------------------------------------
Ver.0.07	08/03/03
----------------------------------------------------------------------

・fenrirのタイトルバーにスキャンの進捗状況を表示できるようにした。

ProgressShow=
fenrirのタイトルバーにプログレスを表示するかしないか。

ProgressUpdatePer=
何個スキャンする毎に表示をアップデートするか。

----------------------------------------------------------------------
Ver.0.06	07/02/15
----------------------------------------------------------------------

・取得できないフォルダがあったのを修正。

----------------------------------------------------------------------
Ver.0.05	07/02/04
----------------------------------------------------------------------

・スキャン高速化。

----------------------------------------------------------------------
Ver.0.04a	07/02/03
----------------------------------------------------------------------

・'*'でスキャン指定したときに、そのスキャン指定したフォルダ自体も取得
していたのを修正。

----------------------------------------------------------------------
Ver.0.04	07/02/02
----------------------------------------------------------------------

・pathやスキャンしたデータから、特定のアイテムを
ワイルドカードマッチングで除去できるようにした。
頭に ! をつけます。
一行に一つです。
単なる文字列マッチであり、'\' にフォルダという意味は持たせていません。
したがってフォルダのみを除去というのはできません。
使い方を間違えると、全部のデータがおじゃんになったりする可能性があるので
ご注意を。


<例> *.iniを除去
!*.ini

<例> c:\foo\barを削除
!c:\foo\bar

<fenrirに組み込む場合のメニュー設定の例>

[.***;
このパスを削除|c:\fenrir\fenrirScan.exe !%P
]

[.\\\;
このフォルダ以下のパスを削除|C:\fenrir\fenrirScan.exe !%P*
]

・スキャン指定で使ったフォルダのパスは登録しないように変更。

例えば、

C:\desktop,*.exe

というスキャン指定では C:\desktop を登録しません。


----------------------------------------------------------------------
Ver.0.03	07/02/01
----------------------------------------------------------------------

・コマンドラインからスキャン指定できるようにした。
(例：c:\fenrir\fenrirScan.exe *C:\desktop,\,*,*)
書式はScanRule.iniと同様です。
複数行は指定できません。
簡易的なスキャンという位置づけなので、パスの存在チェックは行いません。
また、PriorityStockCountを無視し、全てのアイテム並びを保全します。

<fenrirと連携させる場合のメニュー設定の例>

[.\\\;
;%Pを""で囲むと正常動作しないので注意
このフォルダをスキャン|c:\fenrir\fenrirScan.exe *%P,*.*,\
]

----------------------------------------------------------------------
Ver.0.02	07/02/01
----------------------------------------------------------------------

・スキャン中に生じたアイテム並びの変化も、反映できるようになった。
(fenrirを終了させた直後に、pathファイルとスキャンしたデータをマージする
ようにした)

・+c:\foo は、パスの存在チェックを行わないようにした。

・HashSize のデフォルト値を変更。 100001 -> 9973

----------------------------------------------------------------------
Ver.0.01b	07/01/31
----------------------------------------------------------------------

・HashSizeに100001以外の値を指定したときに、不正終了していた不具合を修正。

----------------------------------------------------------------------
Ver.0.01a	07/01/31
----------------------------------------------------------------------

・fenrirを終了するタイミングをスキャンの後にした。

----------------------------------------------------------------------
Ver.0.01	07/01/31
----------------------------------------------------------------------

・初版
